#!/usr/bin/env python
import pika
import time

def publish_messages():
    # Establish connection to RabbitMQ server
    connection = pika.BlockingConnection(pika.ConnectionParameters('localhost'))
    channel = connection.channel()
    
    # Create queue named "ABC" if it doesn't exist
    channel.queue_declare(queue='ABC')
    
    # Send 10 messages
    for i in range(1, 11):
        message = f"Message #{i} from DevOps publisher"
        
        # Publish message to the queue
        channel.basic_publish(
            exchange='',  # Default exchange
            routing_key='ABC',  # Queue name
            body=message
        )
        print(f" [x] Sent: {message}")
        
        # Wait for 1 second between messages
        time.sleep(1)
    
    # Close the connection
    connection.close()
    print("Publisher completed sending all messages.")

if __name__ == '__main__':
    publish_messages()